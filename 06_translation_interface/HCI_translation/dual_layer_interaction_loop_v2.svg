<svg xmlns="http://www.w3.org/2000/svg" width="960" height="620" viewBox="0 0 960 620" role="img" aria-labelledby="ttl desc">
  <title id="ttl">Figure 1 — Dual-Layer Interaction Loop (Rhythm × Transparency)</title>
  <desc id="desc">Two stacked layers: Layer A Rhythm (Cue–Silence–Segment–Drift–Repair) with time hints, and Layer B Epistemic Transparency (Confidence Indicator, Hedging, Calibration, User Trust). A bold purple double arrow indicates the Temporal Transparency Feedback Loop (τ, hedge, trust). Right labels show Resonant Closure RCI&gt;0.8 and TAI formula. Legend includes Telemetry APIs.</desc>

  <defs>
    <style><![CDATA[
      .title { font: 700 18px/1.2 Arial, Helvetica, sans-serif; fill:#2c3e50; }
      .layer-h { font: 700 16px/1.2 Arial, Helvetica, sans-serif; }
      .label { font: 12px/1.25 Arial, Helvetica, sans-serif; fill:#2c3e50; }
      .sublabel { font: 11px/1.25 Arial, Helvetica, sans-serif; fill:#4b4b4b; }
      .tiny { font: 10px/1.25 Arial, Helvetica, sans-serif; fill:#4b4b4b; }
      .legend { font: 12px/1.25 Arial, Helvetica, sans-serif; fill:#2c3e50; }
      .hint { font: 11px/1.25 Arial, Helvetica, sans-serif; fill:#555; }
      .A { stroke:#e67e22; }
      .B { stroke:#2980b9; }
      .C { stroke:#8e44ad; }
    ]]></style>

    <!-- Arrowheads -->
    <marker id="arrowOrange" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="#e67e22"/>
    </marker>
    <marker id="arrowBlue" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="#2980b9"/>
    </marker>
    <marker id="arrowPurple" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="9" markerHeight="9" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="#8e44ad"/>
    </marker>
    <marker id="arrowOrangeSmall" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="#e67e22"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="100%" height="100%" fill="#f8f9fa"/>

  <!-- Figure title -->
  <text x="480" y="36" text-anchor="middle" class="title">Figure 1: Dual-Layer Interaction Loop</text>

  <!-- MAIN GROUP CENTERED -->
  <g transform="translate(480, 330)">

    <!-- ===== Layer A: Rhythm (upper) ===== -->
    <g id="layerA">
      <!-- Frame -->
      <rect x="-380" y="-210" width="760" height="120" fill="none" stroke="#e67e22" stroke-width="2"/>
      <text x="-360" y="-190" class="layer-h" fill="#e67e22">Layer A: Rhythm (Cue–Silence–Segment–Drift–Repair)</text>

      <!-- Nodes with time hints -->
      <!-- horizontal baseline y = -150 -->
      <!-- Cue -->
      <circle cx="-260" cy="-150" r="16" fill="#fdebd0" stroke="#e67e22" stroke-width="2"/>
      <text x="-260" y="-152" text-anchor="middle" class="label">Cue</text>
      <text x="-260" y="-127" text-anchor="middle" class="sublabel">＜100 ms</text>

      <!-- Silence -->
      <circle cx="-130" cy="-150" r="16" fill="#fdebd0" stroke="#e67e22" stroke-width="2"/>
      <text x="-130" y="-152" text-anchor="middle" class="label">Silence</text>
      <text x="-130" y="-127" text-anchor="middle" class="sublabel">200–500 ms</text>

      <!-- Segment -->
      <circle cx="0" cy="-150" r="16" fill="#fdebd0" stroke="#e67e22" stroke-width="2"/>
      <text x="0" y="-152" text-anchor="middle" class="label">Segment</text>
      <text x="0" y="-127" text-anchor="middle" class="sublabel">1–3 s</text>

      <!-- Drift -->
      <circle cx="130" cy="-150" r="16" fill="#fdebd0" stroke="#e67e22" stroke-width="2"/>
      <text x="130" y="-152" text-anchor="middle" class="label">Drift</text>
      <text x="130" y="-127" text-anchor="middle" class="sublabel">&gt;500 ms lag</text>

      <!-- Repair (above line) -->
      <circle cx="260" cy="-180" r="16" fill="#fdebd0" stroke="#e67e22" stroke-width="2"/>
      <text x="260" y="-182" text-anchor="middle" class="label">Repair</text>
      <text x="260" y="-157" text-anchor="middle" class="sublabel">≤ 2 turns</text>

      <!-- Intra-layer flow (solid) -->
      <path d="M -244 -150 L -146 -150" stroke="#e67e22" stroke-width="2" fill="none" marker-end="url(#arrowOrange)"/>
      <path d="M -114 -150 L -16 -150" stroke="#e67e22" stroke-width="2" fill="none" marker-end="url(#arrowOrange)"/>
      <path d="M 16 -150 L 114 -150" stroke="#e67e22" stroke-width="2" fill="none" marker-end="url(#arrowOrange)"/>

      <!-- Dotted arrows to Repair: auto-repair triggers -->
      <path d="M 130 -166 L 248 -174" stroke="#e67e22" stroke-width="1.6" stroke-dasharray="6,4" fill="none" marker-end="url(#arrowOrangeSmall)"/>
      <path d="M 0 -166 L 248 -174" stroke="#e67e22" stroke-width="1.6" stroke-dasharray="6,4" fill="none" marker-end="url(#arrowOrangeSmall)"/>
      <text x="230" y="-205" text-anchor="end" class="tiny" fill="#e67e22">auto-repair triggers</text>

      <!-- Resonant closure badge -->
      <g transform="translate(350,-150)">
        <circle r="22" fill="none" stroke="#e67e22" stroke-width="1.6"/>
        <path d="M -12 -12 L 12 12 M -12 12 L 12 -12" stroke="#e67e22" stroke-width="1.4"/>
        <text x="0" y="34" text-anchor="middle" class="tiny" fill="#6e2c00">Resonant Closure</text>
        <text x="0" y="48" text-anchor="middle" class="tiny" fill="#6e2c00">RCI &gt; 0.8</text>
      </g>
    </g>

    <!-- ===== Layer B: Epistemic Transparency (lower) ===== -->
    <g id="layerB">
      <!-- Frame -->
      <rect x="-380" y="40" width="760" height="120" fill="none" stroke="#2980b9" stroke-width="2"/>
      <text x="-360" y="60" class="layer-h" fill="#2980b9">Layer B: Epistemic Transparency</text>

      <!-- Row baseline y = 100 -->
      <!-- Confidence Indicator -->
      <rect x="-300" y="80" width="190" height="40" rx="6" ry="6" fill="#d6eaf8" stroke="#2980b9" stroke-width="1.5"/>
      <text x="-205" y="104" text-anchor="middle" class="label" fill="#154360">Confidence Indicator (％/icon)</text>

      <!-- Hedging -->
      <rect x="-80" y="80" width="160" height="40" rx="6" ry="6" fill="#d6eaf8" stroke="#2980b9" stroke-width="1.5"/>
      <text x="0" y="104" text-anchor="middle" class="label" fill="#154360">Hedging</text>

      <!-- Calibration -->
      <rect x="120" y="80" width="160" height="40" rx="6" ry="6" fill="#d6eaf8" stroke="#2980b9" stroke-width="1.5"/>
      <text x="200" y="104" text-anchor="middle" class="label" fill="#154360">Calibration</text>

      <!-- User Trust -->
      <rect x="310" y="80" width="190" height="40" rx="6" ry="6" fill="#d6eaf8" stroke="#2980b9" stroke-width="1.5"/>
      <text x="405" y="104" text-anchor="middle" class="label" fill="#154360">User Trust (0–100)</text>

      <!-- Intra-layer flow -->
      <path d="M -110 100 L -90 100" stroke="#2980b9" stroke-width="2" fill="none"/>
      <path d="M 80 100 L 100 100" stroke="#2980b9" stroke-width="2" fill="none"/>
      <path d="M 280 100 L 300 100" stroke="#2980b9" stroke-width="2" fill="none"/>

      <!-- TAI badge with formula -->
      <g transform="translate(350,150)">
        <rect x="-42" y="-16" width="84" height="24" rx="4" ry="4" fill="#2980b9" opacity="0.12" stroke="#2980b9" stroke-width="1.2"/>
        <text x="0" y="0" text-anchor="middle" class="sublabel" fill="#1a5276">TAI</text>
        <text x="0" y="18" text-anchor="middle" class="tiny" fill="#1a5276">TAI = 1 − |trust − acc| / range</text>
      </g>
    </g>

    <!-- ===== Inter-layer coupling: Temporal Transparency Feedback Loop ===== -->
    <!-- Double vertical arrows (purple) -->
    <path d="M -20 -70 L -20 70" stroke="#8e44ad" stroke-width="4" fill="none" marker-end="url(#arrowPurple)"/>
    <path d="M 20 70 L 20 -70" stroke="#8e44ad" stroke-width="4" fill="none" marker-end="url(#arrowPurple)"/>
    <text x="40" y="6" class="hint" fill="#8e44ad">Temporal Transparency Feedback Loop (τ, hedge, trust)</text>

  </g>

  <!-- ===== Legend ===== -->
  <g transform="translate(40, 560)">
    <line x1="0" y1="0" x2="40" y2="0" stroke="#e67e22" stroke-width="3"/>
    <text x="52" y="4" class="legend">Rhythm layer flow</text>

    <line x1="200" y1="0" x2="240" y2="0" stroke="#2980b9" stroke-width="3"/>
    <text x="252" y="4" class="legend">Transparency layer flow</text>

    <line x1="430" y1="0" x2="470" y2="0" stroke="#8e44ad" stroke-width="4"/>
    <text x="482" y="4" class="legend">Inter-layer coupling</text>
  </g>

  <!-- Telemetry APIs note -->
  <g transform="translate(40, 520)">
    <text x="0" y="0" class="legend">Telemetry APIs: <tspan font-weight="700">latency</tspan>, <tspan font-weight="700">confidence</tspan>, <tspan font-weight="700">trust_input</tspan></text>
  </g>
</svg>
